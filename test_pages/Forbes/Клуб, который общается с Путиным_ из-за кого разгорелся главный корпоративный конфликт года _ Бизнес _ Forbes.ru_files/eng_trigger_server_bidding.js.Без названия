window.EngCriteoObj=window.EngCriteoObj||{},window.EngCriteoObj.events=window.EngCriteoObj.events||[];var _ENG_PARTNERS_PENDING_SESSION_IDS=_ENG_PARTNERS_PENDING_SESSION_IDS||new Set,_ENG_CRITEO_SLOT_ID_COUNTER=_ENG_CRITEO_SLOT_ID_COUNTER||0,_ENG_PARTNER_CB_ID_COUNTER=_ENG_PARTNER_CB_ID_COUNTER||0,_ENG_HEADER_BIDDING_INFO=_ENG_HEADER_BIDDING_INFO||{},_ENG_CRITEO_VERSION="5.60",_ENG_COOKIE_NAME=_ENG_COOKIE_NAME||"__eng_header_bidding_info";function _ENG_PARTNERS_pushToRecApi(a,b,c,d,e){var f=_ENG_PARTNERS_get_protocol()+"//sync01.engageya.com/rec-api/"+a+".json?"+b+"="+c+e,g=new XMLHttpRequest;g.open("POST",f,!0),g.send(JSON.stringify(d))}function _ENG_PARTNERS_get_protocol(){return"https:"==window.location.protocol?"https:":"http:"}function _ENG_CRITEO_pushCriteoObjectToRecApi(a,b){var c=_ENG_HEADER_BIDDING_INFO.zoneId+"_"+a;_ENG_PARTNERS_pushToRecApi("pushCriteoObject","keysuffix",c,b,"&crtver="+_ENG_CRITEO_VERSION)}function _ENG_MAILRU_pushMailRuWrapperToRecApi(a,b){_ENG_PARTNERS_pushToRecApi("pushMailRuWrapper","sessionid",a,b,"")}function _ENG_PARTNERS_appendScript(a,b){var c=document.createElement("script");c.type="text/javascript",c.id=b,c.src=a,c.charset="UTF-8",c.async=!0;var d=document.getElementsByTagName("head")[0];d.parentNode.insertBefore(c,d)}function _ENG_PARTNERS_triggerHeaderBidding(a,b){if(!_ENG_HEADER_BIDDING_INFO.hasOwnProperty("countryCode")){var c="eng_headerBiddingInfoCb"+ ++_ENG_PARTNER_CB_ID_COUNTER;window[c]=function(d){_ENG_HEADER_BIDDING_INFO.hasOwnProperty("countryCode")||(_ENG_HEADER_BIDDING_INFO=d,_ENG_PARTNERS_storeHeaderBiddingInfoInCookie()),_ENG_CRITEO_triggerHeaderBidding(a),_ENG_MAILRU_triggerHeaderBidding(a,b)},_ENG_PARTNERS_appendScript(_ENG_PARTNERS_get_protocol()+"//sync01.engageya.com/rec-api/headerBiddingInfo.json?cb="+c+"&wid="+b,"eng_headerBiddingInfoScript"+_ENG_PARTNER_CB_ID_COUNTER)}else _ENG_CRITEO_triggerHeaderBidding(a),_ENG_MAILRU_triggerHeaderBidding(a,b)}function _ENG_MAILRU_triggerHeaderBidding(a,b){if("RU"==_ENG_HEADER_BIDDING_INFO.countryCode&&_ENG_HEADER_BIDDING_INFO.hasOwnProperty("cpmFloor")){var c="MAILRU_"+a;window.eng_MailruCb=function(e){if(_ENG_PARTNERS_PENDING_SESSION_IDS.has(c))if(_ENG_PARTNERS_PENDING_SESSION_IDS.delete(c),void 0!==e[0].html&&""!=e[0].html){for(var f in e)e[f].cpmFloor=_ENG_HEADER_BIDDING_INFO.cpmFloor;_ENG_MAILRU_pushMailRuWrapperToRecApi(a,e)}else _ENG_MAILRU_pushMailRuWrapperToRecApi(a,[{status:"NO_ADS",cpmFloor:_ENG_HEADER_BIDDING_INFO.cpmFloor}])};var d=_ENG_PARTNERS_get_protocol()+"//ad.mail.ru/adq/?q="+_ENG_HEADER_BIDDING_INFO.mailRuService+"&cpm_floor="+_ENG_HEADER_BIDDING_INFO.cpmFloor+"&sitename="+b+"&count="+_ENG_HEADER_BIDDING_INFO.messageCount+"&callback=eng_MailruCb";_ENG_PARTNERS_PENDING_SESSION_IDS.add(c),_ENG_PARTNERS_appendScript(d,"eng_MailRuScript"),_ENG_PARTNERS_SET_DOUBLE_TIMEOUT(2e3,1,function(){_ENG_PARTNERS_PENDING_SESSION_IDS.has(c)&&(_ENG_PARTNERS_PENDING_SESSION_IDS.delete(c),_ENG_MAILRU_pushMailRuWrapperToRecApi(a,[{status:"NO_ADS_TIMEOUT_2000",cpmFloor:_ENG_HEADER_BIDDING_INFO.cpmFloor}]))})}}function _ENG_CRITEO_triggerHeaderBidding(a){var b=parseInt(_ENG_HEADER_BIDDING_INFO.zoneId);if(-1!=b&&1292446!=b){var c="CRITEO_"+a,d=++_ENG_CRITEO_SLOT_ID_COUNTER,e=function(g){_ENG_PARTNERS_PENDING_SESSION_IDS.has(c)&&(_ENG_PARTNERS_PENDING_SESSION_IDS.delete(c),_ENG_CRITEO_pushCriteoObjectToRecApi(a,g))},f=function(g){_ENG_PARTNERS_PENDING_SESSION_IDS.has(c)&&(_ENG_PARTNERS_PENDING_SESSION_IDS.delete(c),console.log("Got passback for adunit = "+g+". key = "+c),_ENG_CRITEO_pushCriteoObjectToRecApi(a,{status:"NO_ADS"}))};_ENG_PARTNERS_PENDING_SESSION_IDS.add(c),EngCriteoObj.events.push(function(){EngCriteoObj.Passback.RequestBids({placements:[{slotid:"eng_nativeunit"+d,sizes:["2x2"],zoneid:b,nativeCallback:e}]},1500)}),EngCriteoObj.events.push(function(){EngCriteoObj.Passback.RenderAd({adUnit:"eng_nativeunit"+d,passback:f})}),_ENG_PARTNERS_SET_DOUBLE_TIMEOUT(275,1,function(){_ENG_PARTNERS_PENDING_SESSION_IDS.has(c)&&(_ENG_PARTNERS_PENDING_SESSION_IDS.delete(c),_ENG_CRITEO_pushCriteoObjectToRecApi(a,{status:"NO_ADS_TIMEOUT_275"}))})}}function _ENG_PARTNERS_SET_DOUBLE_TIMEOUT(a,b,c){setTimeout(function(){setTimeout(c(),b)},a)}function _ENG_PARTNERS_retrieveHeaderBiddingInfoFromCookie(){if(!_ENG_HEADER_BIDDING_INFO.hasOwnProperty("countryCode")){var a="",b="",c=document.cookie.split(";");for(var d in c)if(a=c[d].substr(0,c[d].lastIndexOf("=")),a==_ENG_COOKIE_NAME||a.replace(/^\s+|\s+$/g,"")==_ENG_COOKIE_NAME){b=c[d].substr(c[d].lastIndexOf("=")+1);break}if(""!=b){var e=b.split(":");5==e.length&&(_ENG_HEADER_BIDDING_INFO={countryCode:e[0],zoneId:e[1],mailRuService:e[2],cpmFloor:e[3],messageCount:e[4]})}}}function _ENG_PARTNERS_storeHeaderBiddingInfoInCookie(){var a=_ENG_HEADER_BIDDING_INFO.countryCode+":"+_ENG_HEADER_BIDDING_INFO.zoneId+":"+_ENG_HEADER_BIDDING_INFO.mailRuService+":"+_ENG_HEADER_BIDDING_INFO.cpmFloor+":"+_ENG_HEADER_BIDDING_INFO.messageCount,b=new Date;b.setTime(b.getTime()+3e5),document.cookie=_ENG_COOKIE_NAME+"="+a+"; expires="+b.toGMTString()+"; path=/"}function _ENG_PARTNERS_requestBidsForSavedSessionIds(){_ENG_PARTNERS_retrieveHeaderBiddingInfoFromCookie();for(const[a,b]of _ENG_PARTNERS_SAVED_SESSION_IDS_TO_WIDGET_ID.entries())_ENG_PARTNERS_triggerHeaderBidding(a,b);_ENG_PARTNERS_SAVED_SESSION_IDS_TO_WIDGET_ID=new Map}_ENG_PARTNERS_requestBidsForSavedSessionIds();